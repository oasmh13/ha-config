homeassistant:
  name: Home
  unit_system: metric
  packages: !include_dir_named packages
  internal_url: "http://192.168.178.74:8123"
  # external_url nur wenn extern genutzt wird

# Verlauf (UI)
history:

# Recorder – EINMAL, sauber
recorder:
  purge_keep_days: 365
  commit_interval: 30
  include:
    entity_globs:
      - sensor.*_ist_temperatur
      - sensor.*_soll_temperatur
      - sensor.*shelly*_leistung
      - sensor.*shelly*_power
      - sensor.*shelly*_energie*
      - sensor.frei_leistung
      - sensor.frei_energie
      - sensor.frei_energieeinspeisung
    entities:
      - climate.room_climate_badezimmer_og

frontend:
  themes: !include_dir_merge_named themes
  extra_module_url:
    - /hacsfiles/hass-hue-icons/hass-hue-icons.js

# Ausgelagerte Dateien
automation: !include automations.yaml
script: !include scripts.yaml
template: !include templates.yaml

# Zigbee
zha:
  enable_quirks: true

# Gruppen
group:
  eufy_kameras:
    name: "Eufy Kameras"
    entities:
      - camera.garage
      - camera.garten
      - camera.terrasse
      - camera.vordertur
      - camera.eingang
      - camera.doorbell

# Buttons
input_button:
  night_mode:
    name: "Night Mode"
    icon: mdi:weather-night

# Hue & Utility Meter ausgelagert
hue: !include hue.yaml
utility_meter: !include utility_meter.yaml   # <- einzig gültiger utility_meter-Block

# Sensoren (klassische Integrationen)
sensor:
  - platform: time_date
    display_options:
      - time

  # Tankerkönig – RAW Daten
  - platform: rest
    name: "tankerkonig_94060_raw"
    scan_interval: 600
    timeout: 20
    resource: "https://creativecommons.tankerkoenig.de/json/list.php?lat=48.4015&lng=13.3132&rad=17&sort=price&type=all&apikey=4887d73b-a23e-4581-add8-d10ebac8ae88"
    json_attributes:
      - stations
    value_template: "{{ value_json.ok }}"

# Media Player
media_player:
  - platform: vlc

# Toggles
input_boolean:
  auto_off_enabled:
    name: "Auto-Off OG/EG aktiv"
    icon: mdi:motion-sensor-off
  garage_alarm_3_min:
    name: "Garage Alarm (3 min offen)"
    icon: mdi:alarm-light
  auto_off_include_outdoor:
    name: "Auto-Off: Außenleuchten mit ausschalten"
    icon: mdi:wall-sconce-flat

# Zahlen
input_number:
  roborock_ui_intensity:
    name: "Roborock UI Intensität"
    min: 0.2
    max: 1.0
    step: 0.05
    mode: slider
  auto_off_minutes:
    name: "Auto-Off Wartezeit"
    min: 1
    max: 30
    step: 1
    unit_of_measurement: min
    icon: mdi:timer-outline

# Snapshot-Kamera (cache-sicher)
camera:
  - platform: local_file
    name: Garten Snapshot
    file_path: /config/www/snapshots/garten_latest.jpg

# Optional: Kopie der letzten Aufnahme
shell_command:
  copy_garten_snapshot: cp /config/www/snapshots/garten_latest.jpg /config/www/snapshots/garten_last.jpg
